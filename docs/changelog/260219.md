# Changelog - 260219

## 260219-03:44:12 - Default raw capture noise stripping and harden nested interactive session behavior

### Summary

Made raw capture noise stripping the default, added `--keep-noise` opt-out, and fixed nested interactive/session routing regressions (`session exists --project-root`, waiting-input detection).

### Added

- Added interactive-shell waiting-input classification using pane process-tree inspection with passive helper (`sleep`) filtering.
- Added `session exists --project-root <path>` support in parser/runtime paths and coverage tests.

### Changed

- Changed `session capture --raw` behavior to strip noise by default.
- Added `--keep-noise` flag to preserve startup noise when needed.
- Kept `--strip-noise` as a compatibility alias.
- Updated help, usage, and context docs to reflect the new capture defaults and session-exists root behavior.

### Fixed

- Fixed custom interactive shell sessions not reliably reaching `waiting_input` under nested lisa-agent usage.
- Fixed project-root scoped existence checks for cross-root/session-routing cases.

### Files

- `.agents/sdk-usage.md`
- `.breadcrumbs/260218.md`
- `.breadcrumbs/260219.md`
- `USAGE.md`
- `docs/changelog/260219.md`
- `src/.agents/state-machine.md`
- `src/claude_session_test.go`
- `src/commands_session_manage.go`
- `src/commands_session_state.go`
- `src/coverage_cli_additional_test.go`
- `src/hardening_test.go`
- `src/help.go`
- `src/regressions_test.go`
- `src/status.go`
- `src/tmux.go`
- `src/utils.go`

### QA Notes

- Verify `./lisa session capture <name> --raw` excludes Codex/MCP startup noise by default.
- Verify `./lisa session capture <name> --raw --keep-noise` includes the original startup noise.
- Verify `./lisa session exists <name> --project-root <root>` succeeds for sessions created in that root.
- Verify nested/custom interactive sessions transition to `waiting_input` and `session monitor --stop-on-waiting true` exits with code `0`.
- Verify `go test ./...` remains green.
