# Changelog - 260212

## 260212-07:30:24 - Default --dangerously-skip-permissions for Claude agents

### Summary
Claude agents spawned by Lisa now include `--dangerously-skip-permissions` by default so tool calls are not denied in non-interactive tmux sessions.

### Changed
- `buildAgentCommand` injects `--dangerously-skip-permissions` for Claude agents by default; skips injection for Codex or when already present in `--agent-args`.
- `session spawn` and `agent build-cmd` accept `--no-dangerously-skip-permissions` to opt out.

### Fixed
- Spawned Claude sessions no longer run in "don't ask" mode where Bash tool calls are denied due to missing permission flags.

### Files
- `src/agent_command.go`
- `src/commands_agent.go`
- `src/commands_session.go`
- `src/command_coverage_test.go`
- `src/regressions_test.go`

### QA Notes
- `go test ./src/ -count=1` — all pass

## 260212-07:53:11 - Add --transcript flag to session capture

### Summary
`session capture --transcript` reads Claude's JSONL conversation file to return clean user/assistant messages instead of raw tmux pane output.

### Added
- `src/claude_session.go` — Claude JSONL parsing: session discovery via `history.jsonl` scan + project dir glob fallback, transcript extraction, plain/JSON output formatting.
- `src/claude_session_test.go` — 8 unit tests covering path encoding, message extraction, transcript reading, formatting, session discovery, capture flag, and metadata glob.
- `--transcript` and `--project-root` flags on `session capture`.
- `loadSessionMetaByGlob()` in `session_files.go` — discovers session metadata without knowing project root.

### Files
- `src/claude_session.go` (new)
- `src/claude_session_test.go` (new)
- `src/commands_session_state.go`
- `src/session_files.go`
- `src/run.go`

### QA Notes
- `go test ./src/ -count=1` — all pass
