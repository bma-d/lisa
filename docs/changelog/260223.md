# Changelog - 260223

## 260223-01:27:50 - Expand session contracts and multi-agent orchestration coverage

### Summary
Added new session contract/governance features, aligned skill docs with CLI capabilities, and hardened tests after multi-agent review cycles.

### Added
- `session contract-check` command for schema/docs contract validation.
- New orchestration flags: `--timeout-seconds`, `--since`, `--strict`, `--dedupe`, `--profile`, `--compress`, `--watch-json`, `--watch-interval`, `--watch-cycles`, `--export-artifacts`, `--contract-check`.
- Additional tests for help routing, capabilities error/help paths, and `skills doctor --contract-check` drift detection.

### Changed
- Updated `capabilities` + help surfaces to include all new commands/flags.
- Extended session explain/event tail cursor behavior and list watch streaming behavior.
- Updated Lisa skill docs to reflect current route/handoff/context-pack/smoke/list contracts.

### Fixed
- Closed command/flag drift between Lisa skill docs and actual CLI output.
- Removed test blind spots that could miss help/capability/contract regressions.

### Files
- `.breadcrumbs/260223.md`
- `skills/lisa/SKILL.md`
- `skills/lisa/data/commands.md`
- `skills/lisa/data/validation.md`
- `src/commands_capabilities.go`
- `src/commands_capabilities_test.go`
- `src/commands_session.go`
- `src/commands_session_explain.go`
- `src/commands_session_extended.go`
- `src/commands_session_manage.go`
- `src/commands_session_orchestration.go`
- `src/commands_session_smoke.go`
- `src/commands_session_state.go`
- `src/commands_session_tree.go`
- `src/commands_skills.go`
- `src/help.go`
- `src/help_test.go`
- `src/session_observability.go`
- `src/commands_session_governance.go`
- `src/commands_session_planning.go`
- `src/commands_skills_doctor_fix_test.go`

### QA Notes
- Run `go test ./...` and verify pass.
- Verify `go run . session contract-check --json` returns `ok:true`.
- Verify `go run . skills doctor --contract-check --json` returns `ok:true` for repo + installed targets.
- Manually sanity-check `session list --watch-json --watch-interval 1 --watch-cycles 1 --json-min` output shape.

## 260223-02:19:22 - Enforce watch-json minimal stream and close skill flag drift

### Summary
Fixed watch stream semantics, synced Lisa skill command flags, and added regression coverage.

### Added
- Regression tests for watch-json contract, handoff compression payload, smoke artifact export, route profile presets, and active-only list filtering.

### Changed
- `session list --watch-json` now always enforces `--json-min` output in watch loop invocations.
- Session list help text now documents the correct `--watch-interval` default (`2`).
- Lisa skill command docs now include missing monitor and orchestration flag surfaces.

### Fixed
- Prevented watch mode from emitting heavier full-json payloads when callers pass `--json`.
- Removed command/flag parity drift between skill docs and runtime capabilities.

### Files
- `.breadcrumbs/260223.md`
- `skills/lisa/data/commands.md`
- `src/commands_session_manage.go`
- `src/help.go`
- `src/session_watch_and_contract_regression_test.go`

### QA Notes
- Run `go test ./src -run 'TestCmdSessionListWatchForcesJSONMin|TestCmdSessionHandoffCompressZstdOmitsRecent|TestMaybeExportSmokeArtifactsCopiesWorkdir|TestCmdSessionRouteProfilePreset|TestCmdSessionListActiveOnlyWithoutNextAction|TestUsageDocSessionContract' -count=1`.
- Verify `./lisa skills doctor --repo-root . --contract-check --json` returns `ok:true`.
- Verify `./lisa session list --watch-json --watch-cycles 1 --project-root . --json` emits compact delta-json output.
