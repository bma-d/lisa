# Changelog - 260221

## 260221-00:58:47 - Add nested smoke orchestration, monitor expectation gates, and JSON session helpers

### Summary
Implemented deeper session orchestration primitives for LLM workflows: built-in nested smoke, explicit monitor success expectations, and JSON output for session helper commands.

### Added
- Added `session smoke` command with deterministic nested orchestration validation (`--levels` 1-4), marker assertions, and JSON summary output.
- Added `session monitor --expect any|terminal|marker` to enforce expected success conditions.
- Added `session tree --flat` output for low-token machine parsing.
- Added JSON support for `session name|list|exists|kill|kill-all`.
- Added regression/E2E tests for smoke, monitor expectations, flat tree output, and new JSON helper outputs.

### Changed
- Extended session/router/help surfaces to include smoke command and new monitor/tree/manage flags.
- Improved monitor lifecycle reason emission on expectation mismatch paths.

### Files
- `src/commands_session.go`
- `src/commands_session_manage.go`
- `src/commands_session_state.go`
- `src/commands_session_tree.go`
- `src/commands_session_smoke.go`
- `src/help.go`
- `src/help_test.go`
- `src/e2e_smoke_fake_test.go`
- `src/session_manage_json_test.go`
- `src/session_monitor_expect_test.go`
- `src/session_tree_flat_test.go`
- `docs/changelog/260221.md`

### QA Notes
- Verify nested validation works end-to-end: `./lisa session smoke --project-root "$(pwd)" --levels 4 --json`.
- Verify expectation gating: `./lisa session monitor --session <s> --until-marker DONE --expect terminal --json` returns mismatch reason when marker is hit first.
- Verify helper JSON outputs parse cleanly for `session name|list|exists|kill|kill-all`.
- Verify test suite remains green: `go test ./...`.

