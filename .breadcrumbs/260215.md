# Breadcrumbs 2026-02-15

- **04:13:04**: Resolve documentation drift
  Refreshed docs/index/project-overview/architecture/development-guide/source-tree-analysis, updated project-scan-report, and synced agent.md to current process-first runtime behavior; added changelog 260215 with QA commands.
- **04:24:55** (`USAGE.md`): Add usage reference
  Created USAGE.md with current lisa CLI usage, flags, states, outputs, exit codes, and env vars based on docs/latest-scan.md + src command/help behavior.
- **04:35:27**: Consolidate usage docs
  Made USAGE.md canonical; removed duplicated CLI command/flag/state/exit-code sections from README.md, agent.md, docs/development-guide.md; added USAGE links in docs/index.md and .agents/sdk-usage.md.
- **05:16:14**: Run all e2e + extend coverage
  Ran full e2e matrix with Claude/Codex enabled; added hermetic e2e tests for exists lifecycle, monitor timeout exit-2 path, and explain event payload; stabilized startup execution by launching wrapped startup command via tmux new-session startup script; updated spawn-related tests/mocks to new startup hook; verified go test ./src, go test ./..., and full e2e pass.
- **05:22:26**: Fix session capture default project-root semantics
  cmdSessionCapture now defaults to cwd metadata per USAGE.md, with compatibility fallback to global metadata only when cwd meta is absent and --project-root is not explicit; added regression test for duplicate session-name metadata across projects.
- **05:22:35**: Postflight context sync decision
  No AGENTS/.agents index updates needed: change is a bugfix aligning existing USAGE contract for session capture default project-root behavior; no new files, flags, or workflows introduced.
- **06:30:31** (`src/e2e_interactive_fake_test.go`): Add interactive finish-hook e2e coverage
  Added two tmux-backed e2e tests for project-scoped .claude/settings.json finish-hook flow: (1) hook writes done sidecar and self-removes, monitor reaches completed while session stays interactive; (2) hook waits for simulated subagent completion before writing done sidecar.
- **06:30:31** (`src/session_wrapper.go`): Expose run id to hook subprocesses
  Exported LISA_RUN_ID from session wrapper so finish-hook commands can emit run-id-matching done markers to LISA_DONE_FILE.
- **06:30:46** (`src/.agents/session-lifecycle.md`): Refresh context for hook run-id contract
  Documented that session wrapper exports LISA_RUN_ID so project-scoped finish hooks can write run-id-matching done sidecars via LISA_DONE_FILE.
- **06:31:38** (`src/regressions_test.go`): Guard LISA_RUN_ID export in wrapper tests
  Extended wrapSessionCommand regression token checks to include LISA_RUN_ID so finish-hook integration cannot regress silently.
- **16:43:43** (`src/regressions_test.go`): Add CPU idle regressions
  Added regressions for interactive waiting_input detection, grace-period guard, and exec-mode exemption; updated transcript expectations for new interactive idle classification.
- **16:43:43** (`src/.agents/state-machine.md`): Refresh state-machine context
  Documented CPU-threshold-based interactive waiting_input path and observability signals (interactiveWaiting/activeProcessBusy).
- **16:43:43** (`src/status.go`): Fix waiting_input detection
  Classify interactive sessions as waiting_input when agent PID is alive but CPU is below 0.2 after poll grace period; preserve exec/busy as in_progress.
