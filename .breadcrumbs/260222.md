# Breadcrumbs 2026-02-22

- **00:02:25**: Implement all context-optimization ideas
  Added session autopilot, monitor --until-jsonpath, capture --summary-style, handoff --cursor-file, context-pack --from-handoff, route --budget, list --active-only/--with-next-action, smoke --chaos, guard --enforce, and skills doctor --explain-drift with tests; rebuilt ./lisa and validated help/runtime contracts.
- **00:02:26** (`.agents/sdk-usage.md`): Refresh SDK docs for new orchestration features
  Documented autopilot, jsonpath gating, handoff cursors, from-handoff repack, route budget, list next-action, smoke chaos, guard enforce, and drift remediation guidance.
- **00:40:54**: Fix monitor/jsonpath, smoke mixed marker drop, and handoff mismatch handling
  Patched monitor errorCode gating for successful --until-jsonpath, hardened smoke mixed/drop-marker line removal with explicit target removal, enforced --for/--from-handoff session consistency, and added regression tests in src/session_additional_ideas_test.go
- **00:46:40**: Addressed additional reviewer findings in monitor/smoke
  Prevented --until-marker from overriding successful --until-jsonpath, added regression tests for jsonpath precedence, smoke missing-marker failure payload, and report-min chaos metadata; full go test/go vet green.
- **00:48:54**: Added monitor precedence/JSONPath parsing coverage
  Added tests for JSONPath numeric expectation and invalid expression handling, plus precedence when --until-jsonpath and --until-marker are both set; all tests and vet pass.
- **02:00:23** (`src/oauth_tokens.go`): Add OAuth token pool
  Added secure local Claude OAuth token store (~/.lisa/oauth_tokens.json, 0600), round-robin selector, invalid/expired token detection, and auto-prune helper for crashed/stuck sessions.
- **02:00:23**: Refresh context docs
  Updated AGENTS/.agents docs for new oauth add|list|remove commands, spawn-time token injection, and auto-prune behavior.
- **02:38:57** (`USAGE.md`): Docs: guard/smoke flags
  Documented session guard --enforce and session smoke --chaos modes in USAGE; aligned examples/behavior text.
- **02:38:58** (`src/docs_contract_test.go`): Docs contract: enforce guard/smoke flags
  Added contract assertions for session guard --enforce and session smoke --chaos with supported modes string.
- **02:42:56** (`src/oauth_tokens.go`): Fix concurrent OAuth spawn race
  Added owner-based token reservation/consume/release; preview skips in-flight reservations; stale reservation TTL via LISA_OAUTH_RESERVATION_TTL_SECONDS (default 300s).
- **02:42:57** (`src/commands_session.go`): Wire spawn to reservation lifecycle
  session spawn now reserves Claude OAuth token pre-tmux, consumes after meta save, and auto-releases reservation on failure to keep store/meta consistent.
- **02:42:57** (`src/oauth_tokens_test.go`): Add concurrent spawn regression
  Added focused test proving two concurrent Claude spawns reserve distinct tokens and both succeed; updated spawn OAuth tests to assert rollback release on tmux/meta failure.
- **02:46:28** (`src/oauth_tokens.go`): Preserve owner reservation on consume
  Reservation expiry now clears only non-owner holds during consume so reserved token owner can always finalize selection; TTL still frees stale foreign holds for preview/reserve paths.
- **04:00:00**: Implemented Lisa orchestration features
  Added session packet, autopilot resume-from, route from-state, list delta-json, monitor handoff-cursor-file, capture markers-json, detect-nested --why, guard --advice-only, preflight --fast, tree json-min counts; updated help/capabilities/tests.
- **04:00:04**: Aligned lisa skill docs with runtime contracts
  Updated skills/lisa docs for LISA_TMUX_SOCKET_DIR guidance, new command flags/contracts, and installed updated skill to /Users/joon/.codex/skills/lisa via ./lisa skills install --to codex.
- **04:00:42**: Synced lisa skill installs
  Installed updated repo skill v5.3.0 to codex and claude targets and confirmed skills doctor reports both up_to_date.
- **04:31:56**: Subagent iteration: review->fix->re-review
  Parallel explorers found contract gaps (until-state just_started, list cursor contract, preflight fast duplication, tree filtered counts, docs parity). Parallel workers patched code/docs; rebuilt ./lisa; second-pass explorers reported no findings; tests and contract probes passed.
- **05:55:21**: Implement Lisa orchestration feature set
  Added session schema/checkpoint/dedupe commands; packet fields projection; monitor event-budget; capture semantic-delta; route topology/cost-estimate; context-pack redact; guard machine-policy; list priority; smoke chaos-report; findings fixes for smoke waiting and autopilot resume mode carry-through.
- **05:55:25**: Refresh Lisa skill docs for new contracts
  Updated skills/lisa documentation (SKILL.md, commands.md, recipes, validation, feature ideas) to reflect new flags/subcommands, JSON schema surfaces, and orchestration guidance.
- **06:27:13**: Multi-subagent review/fix iteration complete
  Ran parallel explorer reviews, fixed schema/docs/test findings via worker agents, iterated review until no code-level findings remained, and revalidated with go test ./... + go build.
- **19:47:35**: test models by agent
  Updated test model literals: Claude tests use haiku; Codex tests use GPT-5.3-Codex-Spark. Verified with go test ./src.
